[gd_scene load_steps=4 format=2]

[ext_resource path="res://icon.png" type="Texture" id=1]
[ext_resource path="res://resource/fonts/look16Shadow.tres" type="DynamicFont" id=2]

[sub_resource type="GDScript" id=1]
script/source = "extends PanelContainer

var enemyName=\"Name\"
var enemyClass=\"Standard\"
var enemyLevel=1
var enemyDescription=\"\"
var enemyHp=10
var enemyMaxHp=10
var enemyEnergy=10
var enemyMaxEnergy=10
var enemyStr=1
var enemyDef=1
var enemySpd=1
var enemyGold=100

const tweenParameters={
	\"duration\":0.3,
	\"rect_scale_max\":1.1*Vector2(1,1),
	\"type\":Tween.TRANS_QUINT,
	\"easing\":Tween.EASE_OUT
}

func _ready():
	enemyDescription=\"Strength: \"+String(self.enemyStr)+\", Defense: \"+String(self.enemyDef)+\", Speed: \"+String(self.enemySpd)
	$hboxEnemy/vboxDescription/name.text=self.enemyName
	$hboxEnemy/vboxDescription/title.text=self.enemyClass+\", Lv.\"+String(self.enemyLevel)
	$hboxEnemy/vboxDescription/description.text=self.enemyDescription
#	$hboxEnemy/vboxDescription/name.name=self.enemyName
	self.rect_pivot_offset=self.rect_size/2
	connect(\"mouse_entered\",self,\"twnGrow\")
	connect(\"mouse_exited\",self,\"twnShrink\")
	$hboxEnemy/btn.connect(\"pressed\",self,\"battle\")

func twnGrow():
	$twnScale.interpolate_property(self,\"rect_scale\",self.rect_scale,self.tweenParameters.rect_scale_max,self.tweenParameters.duration,self.tweenParameters.type,self.tweenParameters.easing)
	$twnScale.start()

func twnShrink():
	$twnScale.interpolate_property(self,\"rect_scale\",self.rect_scale,Vector2(1,1),self.tweenParameters.duration,self.tweenParameters.type,self.tweenParameters.easing)
	$twnScale.start()

func battle():
	var maxHp=global.calculateHp(self.enemyStr,self.enemyDef)
	var maxEnergy=global.calculateHp(self.enemyStr,self.enemySpd)
	var enemyDict={
	\"name\":self.enemyName,
	\"gold\":self.enemyGold,
	\"hp\":maxHp,\"maxHp\":maxHp,
	\"energy\":maxEnergy,\"maxEnergy\":maxEnergy,
	\"pointsLeft\":0,
	\"strength\":self.enemyStr,
	\"defense\":self.enemyDef,
	\"speed\":self.enemySpd
	}
	global.battle(enemyDict)
	get_tree().root.get_node(\"/root/opponentControl/marginContainer/opponentPanel/btnExit\").exit()
	
"

[node name="opponentModel" type="PanelContainer"]
margin_top = 110.0
margin_right = 590.0
margin_bottom = 188.0
size_flags_vertical = 5
script = SubResource( 1 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="twnScale" type="Tween" parent="."]

[node name="hboxEnemy" type="HBoxContainer" parent="."]
margin_left = 7.0
margin_top = 7.0
margin_right = 583.0
margin_bottom = 77.0

[node name="icon" type="TextureRect" parent="hboxEnemy"]
margin_right = 64.0
margin_bottom = 70.0
texture = ExtResource( 1 )

[node name="vboxDescription" type="VBoxContainer" parent="hboxEnemy"]
margin_left = 68.0
margin_right = 471.0
margin_bottom = 70.0
size_flags_horizontal = 3
size_flags_stretch_ratio = 8.0

[node name="name" type="Label" parent="hboxEnemy/vboxDescription"]
margin_right = 403.0
margin_bottom = 13.0
size_flags_horizontal = 3
size_flags_stretch_ratio = 7.0
custom_fonts/font = ExtResource( 2 )
text = "GODOTINHO"
align = 1
valign = 1

[node name="title" type="Label" parent="hboxEnemy/vboxDescription"]
margin_top = 17.0
margin_right = 403.0
margin_bottom = 30.0
size_flags_horizontal = 3
size_flags_stretch_ratio = 7.0
custom_fonts/font = ExtResource( 2 )
text = "Standard Lv. 0"
align = 1
valign = 1

[node name="hSeparator" type="HSeparator" parent="hboxEnemy/vboxDescription"]
modulate = Color( 1, 1, 1, 0 )
margin_top = 34.0
margin_right = 403.0
margin_bottom = 38.0
mouse_filter = 2

[node name="description" type="Label" parent="hboxEnemy/vboxDescription"]
margin_top = 42.0
margin_right = 403.0
margin_bottom = 55.0
size_flags_horizontal = 3
size_flags_stretch_ratio = 7.0
custom_fonts/font = ExtResource( 2 )
text = "Lorem ipsum"
align = 1
valign = 1
autowrap = true

[node name="btn" type="Button" parent="hboxEnemy"]
margin_left = 475.0
margin_right = 576.0
margin_bottom = 70.0
mouse_filter = 1
mouse_default_cursor_shape = 2
size_flags_horizontal = 3
size_flags_stretch_ratio = 2.0
text = "Fight!"
